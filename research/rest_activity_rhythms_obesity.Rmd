---
title: "Association of Actigraphy-Measured Rest-Activity Rhythms with Obesity Phenotypes in the Osteoporotic Fractures in Men (MrOS) Study"
author: "Hajin Jang"
date: "3/13/2025"
output: html_document
---

# Abstract

**Background:** Obesity in older adults presents as whole-body, abdominal, or sarcopenic obesity. Disruptions in rest-activity rhythms (RAR) are linked to metabolic disorders, but their role in obesity phenotypes among older men is unclear. This study examines the association between RAR and obesity phenotypes in older men from the Osteoporotic Fractures in Men (MrOS) Study.

**Methods:** This study utilized MrOS 2000-2016 data. A total of 2,989 men aged 65 and older with valid actigraphy, anthropometric, and physical function data, followed up at least once were included. RAR parameters were assessed using wrist-worn actigraphy. RAR variables were categorized into quartiles, where higher amplitude, mesor, interdaily stability (IS), F-statistics, and relative amplitude (RA), as well as lower intradaily variability (IV) and mid-range acrophase, reflect healthier activity rhythms. Obesity phenotypes were classified as whole-body obesity, abdominal, and sarcopenic obesity. Generalized estimating equations models were used to evaluate longitudinal associations between RAR and obesity phenotypes.

**Results:** Lower amplitude, mesor, F-statistics, IS, and RA, as well as earlier acrophase and higher IV, were associated with higher odds of whole-body and abdominal obesity. Associations were generally weaker and less consistent for sarcopenic obesity, though RA remained strongly associated across all obesity types. For example, the lowest quartile of RA compared to the highest quartile was associated with whole-body (OR = 5.62, 95% CI: 4.18-7.56), abdominal (OR= 3.93, 95% CI: 3.17-4.86), and sarcopenic obesity (OR = 3.39, 95% CI: 2.47-4.64).

**Conclusion:** Disrupted RARs may play a role in weight gain and metabolic dysfunction. Irregular activity patterns and reduced day-night variations could be linked to declines in muscle function. Enhancing activity levels and stabilizing RARs could help prevent and manage obesity in aging populations.


```{r}
library(readr)
library(tidyverse)
library(patchwork)
library(geepack)
```


# data importing

```{r}
mros <- read_csv("Data/mros_noNA_wideformat.csv")
mros.l <- read_csv("mros_longformat_v2.csv")

# Convert variables to factors
mros.l <- mros.l %>%
  mutate(
    ID = as.factor(ID),
    slpmed = as.factor(slpmed),
    educat = as.factor(educat),
    racecat = as.factor(racecat),
    site = as.factor(site),
    alc = as.factor(alc),
    smk = as.factor(smk),
    ampQQT = as.factor(ampQQT),
    acroQQT = as.factor(acroQQT),
    mesQQT = as.factor(mesQQT),
    fvalQQT = as.factor(fvalQQT),
    isQQT = as.factor(isQQT),
    ivQQT = as.factor(ivQQT),
    raQQT = as.factor(raQQT)
  )

str(mros.l)

mros.l <- mros.l %>%
  mutate(ampQQT = relevel(ampQQT,4),
         acroQQT = relevel(acroQQT,2),
         mesQQT = relevel(mesQQT,4),
         fvalQQT = relevel(fvalQQT,4),
         isQQT = relevel(isQQT,4),
         ivQQT = relevel(ivQQT,1),
         raQQT = relevel(raQQT,4),
         racecat = relevel(racecat, 1),
         educat = relevel(educat, 2),
         smk = relevel(smk, 1),
         alc = relevel(alc, 1),
         slpmed = relevel(slpmed, 1)
         )
```


# check main outcomes

```{r}
# Summarize binary outcomes across visits
binary_outcome_summary <- mros.l %>%
  group_by(visit) %>%
  summarise(
    wbobe_rate = mean(as.numeric(as.character(wbobe)), na.rm = TRUE),  # Convert factor to numeric
    abobe_rate = mean(as.numeric(as.character(abobe)), na.rm = TRUE),
    saobe_rate = mean(as.numeric(as.character(saobe)), na.rm = TRUE),
    n = n()
  ) %>%
  ungroup()

# Print summary
print(binary_outcome_summary)
```


# trajectory plot

```{r}
# Function to generate trajectory plots for a given variable (without titles)
plot_trajectory <- function(data, variable, y_label, x_breaks) {
  plot_data <- data %>%
    group_by(visit) %>%
    summarize(
      n = sum(!is.na(.data[[variable]])),
      mean = mean(.data[[variable]], na.rm = TRUE),
      sd = sd(.data[[variable]], na.rm = TRUE),
      se = sd / sqrt(n)
    )
  
  ggplot(plot_data, aes(x = visit, y = mean)) +
    # Individual trajectories in light red
    geom_line(data = data %>% drop_na(.data[[variable]]), 
              aes(x = visit, y = .data[[variable]], group = ID), 
              color = "red", linewidth = 0.2, alpha = 0.2) +
    # Error bars for mean Â±1.96*SE
    geom_errorbar(aes(ymin = mean - 1.96 * se, ymax = mean + 1.96 * se),
                  width = 0.4) +
    geom_point(size = 2) +
    geom_line(linewidth = 1) +
    labs(x = "Visit", y = y_label) +  # No title
    scale_x_continuous(breaks = x_breaks) +
    theme_minimal(base_size = 14) +
    theme(plot.title = element_blank(),  # Remove individual titles
          axis.title.y = element_text(size = 14, face = "bold"))
}

# Generate trajectory plots (without individual titles)
plot_bmi <- plot_trajectory(mros.l, "bmi", "BMI", c(1, 2, 3, 4))
plot_waist <- plot_trajectory(mros.l %>% filter(visit %in% c(1, 3)), 
                              "waist", "Waist Circumference (cm)", c(1, 3))
plot_maxgs <- plot_trajectory(mros.l, "maxgs", "Grip Strength", c(1, 2, 3, 4))

# Combine the three plots into one figure
combined_plot <- (plot_bmi | plot_waist | plot_maxgs) +
  plot_annotation(title = "Longitudinal Trajectories of BMI, Waist Circumference, and Grip Strength",
                  theme = theme(plot.title = element_text(size = 15, face = "bold", hjust = 0.5)))

# Display the combined plot
print(combined_plot)
```


# GLMM

```{r}
# make visit a factor variable
mros.l = mros.l %>% dplyr::mutate(visit = as.factor(visit))

# random intercept model with interaction term
wbobe.ri.int = lme4::glmer(formula = wbobe ~  acrophase + visit + acrophase*visit + (1 | ID), 
                         data = mros.l, family = binomial)
summary(wbobe.ri.int)

# standardize acrophase
mros.l <- mros.l %>%
  mutate(acrophase_s = scale(acrophase))  

wbobe.ri.int = lme4::glmer(
  wbobe ~ acrophase_s + visit + acrophase_s * visit + (1 | ID), 
  data = mros.l, 
  family = binomial
)
```


# GEE
## whole-body obesity

```{r}
mros.l <- mros.l[complete.cases(mros.l[, c("age", "racecat", "educat")]), ]
mros.f <- mros.l[complete.cases(mros.l[, c("age", "racecat", "educat", "alc", "totslp", "slpmed", "caf", "pase", "dep", "smk")]), ]

## Whole-body obesity
### Acrophase
acrophase_gee1 <- geeglm(wbobe ~ acroQQT + visit + age + racecat + educat,
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(acrophase_gee1)

acrophase_gee1_results <- broom::tidy(acrophase_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(acrophase_gee1_results, "results/acrophase.csv", row.names = FALSE)

acrophase_gee2 <- geeglm(wbobe ~ acroQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(acrophase_gee2)

acrophase_gee2_results <- broom::tidy(acrophase_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(acrophase_gee2_results, "results/acrophase_adj.csv", row.names = FALSE)

### Amplitude
amp_gee1 <- geeglm(wbobe ~ ampQQT + visit + age + racecat + educat,
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(amp_gee1)

amp_gee1_results <- broom::tidy(amp_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(amp_gee1_results, "results/amplitude.csv", row.names = FALSE)

amp_gee2 <- geeglm(wbobe ~ ampQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(amp_gee2)

amp_gee2_results <- broom::tidy(amp_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(amp_gee2_results, "results/amplitude_adj.csv", row.names = FALSE)

### Mesor
mesor_gee1 <- geeglm(wbobe ~ mesQQT + visit + age + racecat + educat,
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(mesor_gee1)

mesor_gee1_results <- broom::tidy(mesor_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(mesor_gee1_results, "results/mesor.csv", row.names = FALSE)

mes_gee2 <- geeglm(wbobe ~ mesQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(mes_gee2)

mes_gee2_results <- broom::tidy(mes_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(mes_gee2_results, "results/mesor_adj.csv", row.names = FALSE)

### F stat
f_gee1 <- geeglm(wbobe ~ fvalQQT + visit + age + racecat + educat,
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(f_gee1)

f_gee1_results <- broom::tidy(f_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(f_gee1_results, "results/fstat.csv", row.names = FALSE)

f_gee2 <- geeglm(wbobe ~ fvalQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(f_gee2)

f_gee2_results <- broom::tidy(f_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(f_gee2_results, "results/fstat_adj.csv", row.names = FALSE)

### is
is_gee1 <- geeglm(wbobe ~ isQQT + visit + age + racecat + educat,
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(is_gee1)

is_gee1_results <- broom::tidy(is_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(is_gee1_results, "results/is.csv", row.names = FALSE)

is_gee2 <- geeglm(wbobe ~ isQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(is_gee2)

is_gee2_results <- broom::tidy(is_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(is_gee2_results, "results/is_adj.csv", row.names = FALSE)

### iv
iv_gee1 <- geeglm(wbobe ~ ivQQT + visit + age + racecat + educat,
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(iv_gee1)

iv_gee1_results <- broom::tidy(iv_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(iv_gee1_results, "results/iv.csv", row.names = FALSE)

iv_gee2 <- geeglm(wbobe ~ ivQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(iv_gee2)

iv_gee2_results <- broom::tidy(iv_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(iv_gee2_results, "results/iv_adj.csv", row.names = FALSE)

### relative amplitude
ra_gee1 <- geeglm(wbobe ~ raQQT + visit + age + racecat + educat,
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(ra_gee1)

ra_gee1_results <- broom::tidy(ra_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(ra_gee1_results, "results/ra.csv", row.names = FALSE)

ra_gee2 <- geeglm(wbobe ~ raQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(ra_gee2)

ra_gee2_results <- broom::tidy(ra_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(ra_gee2_results, "results/ra_adj.csv", row.names = FALSE)
```

### test for interaction

```{r}

# model 1
wbobe_acrophase <- geeglm(wbobe ~  acroQQT * visit + age + racecat + educat, 
                          data = mros.l, id = ID, family = binomial, corstr = "exchangeable")
summary(wbobe_acrophase) # no inter

wbobe_amplitude <- geeglm(wbobe ~  ampQQT * visit + age + racecat + educat, 
                          data = mros.l, id = ID, family = binomial, corstr = "exchangeable")
summary(wbobe_amplitude) # no inter

wbobe_mesor <- geeglm(wbobe ~  mesQQT * visit + age + racecat + educat, 
                      data = mros.l, id = ID, family = binomial, corstr = "exchangeable")
summary(wbobe_mesor) # no inter

wbobe_fstat <- geeglm(wbobe ~ fvalQQT * visit + age + racecat + educat, 
                      data = mros.l, id = ID, family = binomial, corstr = "exchangeable")
summary(wbobe_fstat) # yes

wbobe_is <- geeglm(wbobe ~isQQT * visit + age + racecat + educat, 
                   data = mros.l, id = ID, family = binomial, corstr = "exchangeable")
summary(wbobe_is) # yes

wbobe_iv <- geeglm(wbobe ~ ivQQT * visit + age + racecat + educat, 
                   data = mros.l, id = ID, family = binomial, corstr = "exchangeable")
summary(wbobe_iv) # no

wbobe_relativeamp <- geeglm(wbobe ~ raQQT * visit + age + racecat + educat, 
                            data = mros.l, id = ID, family = binomial, corstr = "exchangeable")
summary(wbobe_relativeamp) # no

# full model
wbobe_acrophase <- geeglm(wbobe ~  acroQQT * visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep, 
                          data = mros.f, id = ID, family = binomial, corstr = "exchangeable")
summary(wbobe_acrophase) # no inter

wbobe_amplitude <- geeglm(wbobe ~  ampQQT * visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep, 
                          data = mros.f, id = ID, family = binomial, corstr = "exchangeable")
summary(wbobe_amplitude) # no inter

wbobe_mesor <- geeglm(wbobe ~  mesQQT * visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep, 
                      data = mros.f, id = ID, family = binomial, corstr = "exchangeable")
summary(wbobe_mesor) # no inter

wbobe_fstat <- geeglm(wbobe ~ fvalQQT * visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep, 
                      data = mros.f, id = ID, family = binomial, corstr = "exchangeable")
summary(wbobe_fstat) # yes

wbobe_is <- geeglm(wbobe ~isQQT * visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep, 
                   data = mros.f, id = ID, family = binomial, corstr = "exchangeable")
summary(wbobe_is) # no

wbobe_iv <- geeglm(wbobe ~ ivQQT * visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep, 
                   data = mros.f, id = ID, family = binomial, corstr = "exchangeable")
summary(wbobe_iv) # no

wbobe_relativeamp <- geeglm(wbobe ~ raQQT * visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep, 
                            data = mros.f, id = ID, family = binomial, corstr = "exchangeable")
summary(wbobe_relativeamp) # no
```


## abdominal obesity

```{r}
## abdominal obesity
### Acrophase
acrophase_gee1 <- geeglm(abobe ~ acroQQT + visit + age + racecat + educat, # no int
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(acrophase_gee1)

acrophase_gee1_results <- broom::tidy(acrophase_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(acrophase_gee1_results, "results/abobe_acrophase.csv", row.names = FALSE)

acrophase_gee2 <- geeglm(abobe ~ acroQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") # no int
summary(acrophase_gee2)

acrophase_gee2_results <- broom::tidy(acrophase_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(acrophase_gee2_results, "results/abobe_acrophase_adj.csv", row.names = FALSE)

### Amplitude
amp_gee1 <- geeglm(abobe ~ ampQQT + visit + age + racecat + educat, # yes int
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(amp_gee1)

amp_gee1_results <- broom::tidy(amp_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(amp_gee1_results, "results/abobe_amplitude.csv", row.names = FALSE)

amp_gee2 <- geeglm(abobe ~ ampQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") # yes int
summary(amp_gee2)

amp_gee2_results <- broom::tidy(amp_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(amp_gee2_results, "results/abobe_amplitude_adj.csv", row.names = FALSE)

### Mesor
mesor_gee1 <- geeglm(abobe ~ mesQQT + visit + age + racecat + educat, # yes int
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(mesor_gee1)

mesor_gee1_results <- broom::tidy(mesor_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(mesor_gee1_results, "results/abobe_mesor.csv", row.names = FALSE)

mes_gee2 <- geeglm(abobe ~ mesQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable")# yes int
summary(mes_gee2)

mes_gee2_results <- broom::tidy(mes_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(mes_gee2_results, "results/abobe_mesor_adj.csv", row.names = FALSE)

### F stat
f_gee1 <- geeglm(abobe ~ fvalQQT + visit + age + racecat + educat, # yes int
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(f_gee1)

f_gee1_results <- broom::tidy(f_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(f_gee1_results, "results/abobe_fstat.csv", row.names = FALSE)

f_gee2 <- geeglm(abobe ~ fvalQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") # yes int
summary(f_gee2)

f_gee2_results <- broom::tidy(f_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(f_gee2_results, "results/abobe_fstat_adj.csv", row.names = FALSE)

### is
is_gee1 <- geeglm(abobe ~ isQQT + visit + age + racecat + educat, # yes int
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(is_gee1)

is_gee1_results <- broom::tidy(is_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(is_gee1_results, "results/abobe_is.csv", row.names = FALSE)

is_gee2 <- geeglm(abobe ~ isQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") # no int
summary(is_gee2)

is_gee2_results <- broom::tidy(is_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(is_gee2_results, "results/abobe_is_adj.csv", row.names = FALSE)

### iv
iv_gee1 <- geeglm(abobe ~ ivQQT + visit + age + racecat + educat, # no int
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(iv_gee1)

iv_gee1_results <- broom::tidy(iv_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(iv_gee1_results, "results/abobe_iv.csv", row.names = FALSE)

iv_gee2 <- geeglm(abobe ~ ivQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") # no int
summary(iv_gee2)

iv_gee2_results <- broom::tidy(iv_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(iv_gee2_results, "results/abobe_iv_adj.csv", row.names = FALSE)

### relative amplitude
ra_gee1 <- geeglm(abobe ~ raQQT + visit + age + racecat + educat, # yes int
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(ra_gee1)

ra_gee1_results <- broom::tidy(ra_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(ra_gee1_results, "results/abobe_ra.csv", row.names = FALSE)

ra_gee2 <- geeglm(abobe ~ raQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") # yes int
summary(ra_gee2)

ra_gee2_results <- broom::tidy(ra_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(ra_gee2_results, "results/abobe_ra_adj.csv", row.names = FALSE)
```


## sarcopenic obesity

```{r}
## Sarcopenic obesity
### Acrophase
acrophase_gee1 <- geeglm(saobe ~ acroQQT + visit + age + racecat + educat, # no int
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(acrophase_gee1)

acrophase_gee1_results <- broom::tidy(acrophase_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(acrophase_gee1_results, "results/saobe_acrophase.csv", row.names = FALSE)

acrophase_gee2 <- geeglm(saobe ~ acroQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") # yes int
summary(acrophase_gee2)

acrophase_gee2_results <- broom::tidy(acrophase_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(acrophase_gee2_results, "results/saobe_acrophase_adj.csv", row.names = FALSE)

### Amplitude
amp_gee1 <- geeglm(saobe ~ ampQQT + visit + age + racecat + educat, # no int
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(amp_gee1)

amp_gee1_results <- broom::tidy(amp_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(amp_gee1_results, "results/saobe_amplitude.csv", row.names = FALSE)

amp_gee2 <- geeglm(saobe ~ ampQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") # no int
summary(amp_gee2)

amp_gee2_results <- broom::tidy(amp_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(amp_gee2_results, "results/saobe_amplitude_adj.csv", row.names = FALSE)

### Mesor
mesor_gee1 <- geeglm(saobe ~ mesQQT + visit + age + racecat + educat, # no int
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(mesor_gee1)

mesor_gee1_results <- broom::tidy(mesor_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(mesor_gee1_results, "results/saobe_mesor.csv", row.names = FALSE)

mes_gee2 <- geeglm(saobe ~ mesQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") # no int
summary(mes_gee2)

mes_gee2_results <- broom::tidy(mes_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(mes_gee2_results, "results/saobe_mesor_adj.csv", row.names = FALSE)

### F stat
f_gee1 <- geeglm(saobe ~ fvalQQT + visit + age + racecat + educat, # no int
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(f_gee1)

f_gee1_results <- broom::tidy(f_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(f_gee1_results, "results/saobe_fstat.csv", row.names = FALSE)

f_gee2 <- geeglm(saobe ~ fvalQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") # no int
summary(f_gee2)

f_gee2_results <- broom::tidy(f_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(f_gee2_results, "results/saobe_fstat_adj.csv", row.names = FALSE)

### is
is_gee1 <- geeglm(saobe ~ isQQT + visit + age + racecat + educat, # no int
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(is_gee1)

is_gee1_results <- broom::tidy(is_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(is_gee1_results, "results/saobe_is.csv", row.names = FALSE)

is_gee2 <- geeglm(saobe ~ isQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") # no int
summary(is_gee2)

is_gee2_results <- broom::tidy(is_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(is_gee2_results, "results/saobe_is_adj.csv", row.names = FALSE)

### iv
iv_gee1 <- geeglm(saobe ~ ivQQT + visit + age + racecat + educat, # no int
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(iv_gee1)

iv_gee1_results <- broom::tidy(iv_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(iv_gee1_results, "results/saobe_iv.csv", row.names = FALSE)

iv_gee2 <- geeglm(saobe ~ ivQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") # no int
summary(iv_gee2)

iv_gee2_results <- broom::tidy(iv_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(iv_gee2_results, "results/saobe_iv_adj.csv", row.names = FALSE)

### relative amplitude
ra_gee1 <- geeglm(saobe ~ raQQT + visit + age + racecat + educat, # no int
                    data = mros.l, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") 
summary(ra_gee1)

ra_gee1_results <- broom::tidy(ra_gee1, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(ra_gee1_results, "results/saobe_ra.csv", row.names = FALSE)

ra_gee2 <- geeglm(saobe ~ raQQT + visit + age + racecat + educat + alc + totslp + slpmed + caf + smk + pase + dep,
                    data = mros.f, 
                    id = ID,         
                    family = binomial, 
                    corstr = "exchangeable") # no int
summary(ra_gee2)

ra_gee2_results <- broom::tidy(ra_gee2, conf.int = TRUE) %>%
  mutate(
    estimate = exp(estimate),       
    conf.low = exp(conf.low),       
    conf.high = exp(conf.high)
  )

write.csv(ra_gee2_results, "results/saobe_ra_adj.csv", row.names = FALSE)
```

