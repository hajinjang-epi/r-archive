---
title: "Associations of Obesity Phenotypes with Incident Fall Rates: Results from the Objective Physical Activity and Cardiovascular Health in Older Women (OPACH) Study"
author: "Hajin Jang"
date: "6/1/2024"
output: html_document
---

## Abstract

**Background:** Obesity and sarcopenia may influence fall risk through different mechanisms, but how different phenotypes affect fall rates is unclear, especially among older women. This study examined associations of whole-body obesity, abdominal obesity, and sarcopenic obesity with incident fall rates among community-dwelling older women in the United States.

**Methods:** We analyzed data from 4,654 ambulatory women aged 63 years in the Objective Physical Activity and Cardiovascular Health study, an ancillary study of the Women’s Health Initiative. Whole-body overweight and obesity were defined as body mass index (BMI) 25 to <30 kg/m2 and 30 kg/m2, respectively; abdominal obesity as waist circumference >88 cm; and sarcopenia as grip strength <20 kg. Sarcopenic obesity was defined as the coexistence of obesity (either whole-body or abdominal) and sarcopenia. Falls were recorded using daily calendars over 13 months. Negative binomial regression models estimated associations between obesity phenotypes and monthly fall rates, adjusting for demographic, behavioral, and health-related covariates.

**Results:** Whole-body overweight and obesity were associated with lower fall rates compared to normal BMI (overweight IRR=0.82, 95% CI=0.73, 0.92; obesity IRR=0.76, 95% CI=0.66, 0.87). Abdominal obesity showed a modest association with reduced fall rates (IRR=0.87, 95% CI=0.78, 0.96). In contrast, sarcopenia alone (IRR=1.44, 95% CI=1.24, 1.68), and sarcopenic obesity (IRR=1.20, 95% CI=1.03, 1.39) were associated with significantly higher fall rates.

**Conclusions:** Our findings underscore the critical role of muscle strength loss, rather than excess adiposity, in fall risk among older women. Future interventions to reduce sarcopenia may reduce fall rates.


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Library

```{r}
library(table1)
library(tableone)
library(dplyr)
library(ggplot2)
library(gtsummary)
library(haven)
library(pscl)   
library(car)  
library(MASS)
library(DHARMa)
library(tidyr)
library(broom)
```


## Data

```{r}
## data0: Import datset generated by Chen
data0 <- read.csv("Z:/Jang/data_except_comorbidities.csv")
dim(data0)

## whills: Import whills dataset
whills <- read.table("Z:/Fall Injuries Combined Studies/WHI/DAT Data copies/f301_whills_inv.dat",header=T,fill = T,sep="\t")
dim(whills)

## data1: Add obesity-related variables
data1 <- whills[, c("ID", "WEIGHT", "HEIGHT", "WAIST", "GRIPCOMP", "GRIPDOM", "RGRIPSTR1", "RGRIPSTR2", "LGRIPSTR1", "LGRIPSTR2")]
data1 <- left_join(data0, data1, by="ID")
head(data1)
```


## Obesity-related variables

```{r}
## BMI_calculated: kg/m2
data1 <- data1 %>% mutate(BMI_calculated = (WEIGHT * 0.453592) / ((HEIGHT * 0.0254) ^ 2))
summary(data1$BMI_calculated)
## BMI_cat: underweight, normal, overweight, obese
data1 <- data1 %>% mutate(BMI_cat = cut(BMI_calculated, breaks = c(-Inf, 18.5, 25, 30, Inf), labels = c("underweight", "normal", "overweight", "obese"), right = FALSE))
data1$BMI_cat <- factor(data1$BMI_cat)
data1$BMI_cat <- relevel(data1$BMI_cat, ref = "normal")
tab1 <- data.frame(freq = table(data1$BMI_cat), prop = prop.table(table(data1$BMI_cat)))
print(tab1)
## BMI_cat2: collapse underweight (n=88) and normal category
data1 <- data1 %>% mutate(BMI_cat2 = case_when(BMI_cat %in% c("underweight", "normal") ~ "underweight/normal",BMI_cat == "overweight" ~ "overweight", BMI_cat == "obese" ~ "obese", TRUE ~ as.character(BMI_cat)))
data1$BMI_cat2 <- factor(data1$BMI_cat2)
data1$BMI_cat2 <- relevel(data1$BMI_cat2, ref = "underweight/normal")
data1 <- data1 %>% mutate(BMI_cat2_level = case_when(BMI_cat2 == "underweight/normal" ~ 1, BMI_cat2 == "overweight" ~ 2, BMI_cat2 == "obese" ~ 3, TRUE ~ NA_real_))
## wbobe: BMI<30 vs. BMI>=30
data1 <- data1 %>% mutate(wbobe = ifelse(BMI_calculated >= 30, 1, 0))
tab2 <- data.frame(freq = table(data1$wbobe), prop = prop.table(table(data1$wbobe)))
print(tab2)
## abobe: wc<35 vs. wc>=35
data1 <- data1 %>% mutate(abobe = ifelse(WAIST >= 35, 1, 0))
tab3 <- data.frame(freq = table(data1$abobe), prop = prop.table(table(data1$abobe)))
print(tab3)
## saobe: grip strength of dominant hand < 20kg
data1 <- data1 %>% mutate(avg_right = rowMeans(cbind(RGRIPSTR1, RGRIPSTR2), na.rm = TRUE),
                          avg_left = rowMeans(cbind(LGRIPSTR1, LGRIPSTR2), na.rm = TRUE))
data1 <- data1 %>% mutate(avg_dominant = case_when(is.na(GRIPDOM) | GRIPDOM == 3 ~ avg_right, 
                                                                    GRIPDOM == 1 ~ avg_right,
                                                                   TRUE ~ avg_left))
data1 <- data1 %>% mutate(sar = ifelse(avg_dominant < 20, 1, 0))
data1 <- data1 %>% mutate(obecon = if_else(wbobe == 1 | abobe == 1, 1, 0),
                           saobe = case_when(sar == 0 & obecon == 0 ~ 1, sar == 0 & obecon == 1 ~ 2, 
                                             sar == 1 & obecon == 0 ~ 3, sar == 1 & obecon == 1 ~ 4,TRUE ~ NA_integer_))

data1$saobe <- factor(data1$saobe)

## cross-tabulation
table(data1$BMI_cat, useNA = "ifany")
table(data1$BMI_cat2, useNA = "ifany")
table(data1$wbobe, useNA = "ifany")
table(data1$abobe, useNA = "ifany")
table(data1$saobe, useNA = "ifany")
table(data1$wbobe, data1$abobe, useNA = "ifany")
table(data1$wbobe, data1$saobe, useNA = "ifany")
table(data1$abobe, data1$saobe, useNA = "ifany")
```


## Covariates

```{r}
## Age
summary(data1$AGE)
data1 <- data1 %>% mutate(AGE_cat = ifelse(AGE >= 65 & AGE <= 85, '65-85 years', '85+ years'))
table(data1$AGE_cat)
## TEXPWK2 (physical activity level)
data1 <- data1 %>% mutate(TEXPWK2=ifelse(is.na(TEXPWK)==T, "Unknown", ifelse(TEXPWK<21,"Inactive","ACTIVE")))

## Convert AGE and total_pa_mins to numeric if they are not
data1$AGE <- as.numeric(data1$AGE)
data1$totalpa_mins <- as.numeric(data1$totalpa_mins)
data1$BMI_calculated <- as.numeric(data1$BMI_calculated)
```


## Exclusion

```{r}
## data2: Exclude ppts who did not return fall calendar
data2 <- data1 %>% filter(calcount>=1)
dim(data2) # N=5971

## data3: Exclude ppts with missing wbobe and abobe
data3 <- data2 %>% filter(is.na(wbobe)==F & is.na(abobe)==F)
dim(data3) # N=5906

## data4: Exclude ppts with missing totalpa_mins
data4 <- data3 %>% filter(!is.na(totalpa_mins))
dim(data4)

## data (base sample): Exclude ppts with missing saobe2
data <- data4 %>% filter(!is.na(saobe)) # N=5367
dim(data)

write.csv(data,file="Z:/Jang/datafinal.csv")
```


## Descriptive statistics

```{r}
## Convert other variables to factor if they are not
vars_to_factor <- c("RACE", "ETHNICNIH", "EDUC2", "SMOKNOW", "ALCOHOL", "HLTHC1Y", "BMI_cat", "abobe", "saobe")
data[vars_to_factor] <- lapply(data[vars_to_factor], factor)

## Create Table 1
vars <- c("AGE", "RACE", "ETHNICNIH", "EDUC2", "SMOKNOW", "ALCOHOL", "totalpa_mins", "HLTHC1Y", "BMI_calculated", "BMI_cat", "abobe", "saobe")

table1 <- CreateTableOne(vars = vars, strata = "BMI_cat", data = data, test = TRUE)
table1 <- print(table1, showAllLevels = TRUE)
write.csv(table1,file="table1.csv")

table2 <- CreateTableOne(vars = vars, strata = "fall", data = data, test = TRUE)
table2 <- print(table2, showAllLevels = TRUE)
write.csv(table2,file="table2.csv")

table3 <- CreateTableOne(vars = vars, strata = "INJFALLFLG", data = data, test = TRUE)
table3 <- print(table3, showAllLevels = TRUE)
write.csv(table3,file="table3.csv")

table4 <- CreateTableOne(vars = vars, strata = "abobe", data = data, test = TRUE)
table4 <- print(table4, showAllLevels = TRUE)
write.csv(table4,file="table4.csv")

table5 <- CreateTableOne(vars = vars, strata = "saobe", data = data, test = TRUE)
table5 <- print(table5, showAllLevels = TRUE)
write.csv(table5,file="table5.csv")
```



# 1. Fall rates

## Whole-body obesity (4 categories)

```{r}
## Fit a Poisson regression model
model0 <- glm(fallcount ~ BMI_cat + offset(log(calcount)), family = poisson(link="log"), data = data)
confint(model0)
summary(model0)
  # residual deviance=15366, df=5363
  # overdispersion parameter was significantly greater than 1 (5366/5363=2.9)


## Fit a Negative Binomial regression model
## model1: univariate
model1 <- glm.nb(fallcount ~ BMI_cat + offset(log(calcount)), data = data)
summary(model1)
exp(coef(model1))
exp(confint(model1))

## model2: model1 + age + race + education 
model2 <- glm.nb(fallcount ~ BMI_cat + offset(log(calcount)) + AGE + RACE + ETHNICNIH + EDUC2, data = data)
summary(model2)
exp(coef(model2))
exp(confint(model2))


###############################################################
# model2 + pa
model3 <- glm.nb(fallcount ~ BMI_cat + offset(log(calcount)) + AGE + RACE + ETHNICNIH + EDUC2 + totalpa_mins, data = data)
summary(model3)
exp(coef(model3))
exp(confint(model3)) 
# model2 + alcohol
model3 <- glm.nb(fallcount ~ BMI_cat + offset(log(calcount)) + AGE + RACE + ETHNICNIH + EDUC2 + ALCOHOL, data = data)
summary(model3)
exp(coef(model3))
exp(confint(model3)) 
# model2 + smoking
model3 <- glm.nb(fallcount ~ BMI_cat + offset(log(calcount)) + AGE + RACE + ETHNICNIH + EDUC2 + SMOKNOW, data = data)
summary(model3)
exp(coef(model3))
exp(confint(model3)) 
###############################################################


## model3: model2 + physical activity level + smoking + alcohol drinking
model3 <- glm.nb(fallcount ~ BMI_cat + offset(log(calcount)) + AGE + RACE + ETHNICNIH + EDUC2 + SMOKNOW + ALCOHOL + totalpa_mins, data = data)
summary(model3)
exp(coef(model3))
exp(confint(model3))

## model4: model3 + self-rated health
model4 <- glm.nb(fallcount ~ BMI_cat + offset(log(calcount)) + AGE + RACE + ETHNICNIH + EDUC2 + SMOKNOW + ALCOHOL + totalpa_mins + HLTHC1Y, data = data)
summary(model4)
exp(coef(model4))
exp(confint(model4))
```


## Abdominal obesity

```{r}
## Fit a Poisson regression model
model0 <- glm(fallcount ~ abobe + BMI_cat + offset(log(calcount)), family = poisson(link="log"), data = data)
confint(model0)
summary(model0)
  # residual deviance=15361, df=5362
  # overdispersion parameter was significantly greater than 1 (15361/5362=2.9)

## Fit a Negative Binomial regression model
## model1: univariate
model1 <- glm.nb(fallcount ~ abobe + offset(log(calcount)), data = data)
summary(model1)
exp(coef(model1))
exp(confint(model1))

## model2: model1 + age + race + education 
model2 <- glm.nb(fallcount ~ abobe + BMI_cat + offset(log(calcount)) + AGE + RACE + ETHNICNIH + EDUC2, data = data)
summary(model2)
exp(coef(model2))
exp(confint(model2))

###############################################################
# model1 + age
model2 <- glm.nb(fallcount ~ abobe + BMI_cat + offset(log(calcount)) + AGE, data = data)
summary(model2)
exp(coef(model2))
exp(confint(model2))
# model1 + race
model2 <- glm.nb(fallcount ~ abobe + BMI_cat + offset(log(calcount)) + RACE, data = data)
summary(model2)
exp(coef(model2))
exp(confint(model2))
# model1 + ethnicity
model2 <- glm.nb(fallcount ~ abobe + BMI_cat + offset(log(calcount)) + ETHNICNIH, data = data)
summary(model2)
exp(coef(model2))
exp(confint(model2))
# model1 + education
model2 <- glm.nb(fallcount ~ abobe + BMI_cat + offset(log(calcount)) + EDUC2, data = data)
summary(model2)
exp(coef(model2))
exp(confint(model2))
###############################################################


## model3: model2 + physical activity level + smoking + alcohol drinking
model3 <- glm.nb(fallcount ~ abobe + BMI_cat + offset(log(calcount)) + AGE + RACE + ETHNICNIH + EDUC2 + SMOKNOW + ALCOHOL + totalpa_mins, data = data)
summary(model3)
exp(coef(model3))
exp(confint(model3))

## model4: model3 + self-rated health
model4 <- glm.nb(fallcount ~ abobe + offset(log(calcount)) + AGE + RACE + ETHNICNIH + EDUC2 + SMOKNOW + ALCOHOL + totalpa_mins + HLTHC1Y, data = data)
summary(model4)
exp(coef(model4))
exp(confint(model4))
```


## Sarcopenic obesity

```{r}
## Fit a Poisson regression model
model0 <- glm(fallcount ~ saobe + offset(log(calcount)), family = poisson(link="log"), data = data)
confint(model0)
summary(model0)
  # residual deviance=15144, df=5363
  # overdispersion parameter was significantly greater than 1 (15144/5363=2.8)

## Fit a Negative Binomial regression model
## model1: univariate
model1 <- glm.nb(fallcount ~ saobe  + offset(log(calcount)), data = data)
summary(model1)
exp(coef(model1))
exp(confint(model1))

## model2: model1 + age + race + education 
model2 <- glm.nb(fallcount ~ saobe + offset(log(calcount)) + AGE + RACE + ETHNICNIH + EDUC2, data = data)
summary(model2)
exp(coef(model2))
exp(confint(model2))

## model3: model2 + physical activity level + smoking + alcohol drinking
model3 <- glm.nb(fallcount ~ saobe + offset(log(calcount)) + AGE + RACE + ETHNICNIH + EDUC2 + SMOKNOW + ALCOHOL + totalpa_mins, data = data)
summary(model3)
exp(coef(model3))
exp(confint(model3))

data$RACE <- factor(data$RACE)
data$ETHNICNIH <- factor(data$ETHNICNIH)
data$EDUC2 <- factor(data$EDUC2)
data$SMOKNOW <- factor(data$SMOKNOW)
data$ALCOHOL <- factor(data$ALCOHOL)
data$HLTHC1Y <- factor(data$HLTHC1Y)

## model4: model3 + self-rated health
model4 <- glm.nb(fallcount ~ saobe + offset(log(calcount)) + AGE + RACE + ETHNICNIH + EDUC2 + SMOKING + DRINKING + totalpa_mins + HLTHC1Y, data = data,link="log")
summary(model4)
exp(coef(model4))
exp(confint(model4))

table(data$fallcount)

mean(data$totalpa_mins)
sd(data$totalpa_mins)
median(data$totalpa_mins)
min(data$totalpa_mins)

data$SMOKING <- ifelse(is.na(data$SMOKNOW), "Unknown",
                        ifelse(data$SMOKNOW == 1, "Yes", "No"))

data$DRINKING <- ifelse(is.na(data$ALCOHOL), "Unknown",
                        ifelse(data$ALCOHOL == "<1 drink per week", "<1 drink per week",
                        ifelse(data$ALCOHOL == ">4 drinks per week", ">4 drinks per week",
                        ifelse(data$ALCOHOL == "1-4 drinks per week", "1-4 drinks per week",
                        ifelse(data$ALCOHOL == "Never", "Never", NA)))))


table(data$ALCOHOL)
table(data$DRINKING)
```



# 2. Fall injuries

## 2-1. Non-injurious falls vs. Injurious falls

## Whole-body obesity (4 categories)

```{r}
## IPW multivariable logstic regression
datainj <- data %>% filter(!is.na(INJFALLFLG))
datainj <- datainj %>% filter(TEXPWK2!="Unknown")
datainj <- datainj %>% mutate(W = ifelse(TEXPWK2 == "Inactive", 5, 1))

## model1: univariate
data2$INJFALLFLG <- factor(data2$INJFALLFLG, levels = c("0", "1"))
model1 <- glm(INJFALLFLG ~ BMI_cat, data = data2, family = binomial(),weights = W)
summary(model1)
exp(coef(model1))
exp(confint(model1))

## model2: model1 + age + race + education 
model2 <- glm(INJFALLFLG ~ BMI_cat + AGE + RACE + ETHNICNIH + EDUC2, data = data2, family = binomial(),weights = W)
summary(model2)
exp(coef(model2))
exp(confint(model2))

## model3: model2 + physical activity level + smoking + alcohol drinking
model3 <- glm(INJFALLFLG ~ BMI_cat + AGE + RACE + ETHNICNIH + EDUC2 + SMOKNOW + ALCOHOL + totalpa_mins, data = data2, family = binomial(),weights = W)
summary(model3)
exp(coef(model3))
exp(confint(model3))

## model4: model3 + self-rated health
model4 <- glm(INJFALLFLG ~ BMI_cat + AGE + RACE + ETHNICNIH + EDUC2 + SMOKNOW + ALCOHOL + totalpa_mins + HLTHC1Y, data = data2, family = binomial(),weights = W)
summary(model4)
exp(coef(model4))
exp(confint(model4))
```


# 2-2. No fall vs. Injurious falls

## Whole-body obesity (4 categories)
```{r}
## Take all those with fallcount=0 and INJFALLFLG=1
subset1 <- data %>% filter(fallcount ==0)
subset1$fallinjury_yn <- 0
subset2 <- data %>% filter(INJFALLFLG ==1)
subset2$fallinjury_yn <- 1
subset <- bind_rows(subset1, subset2)

## model1: univariate
model1 <- glm(INJFALLFLG ~ BMI_cat, data = subset, family = binomial())
summary(model1)
exp(coef(model1))
exp(confint(model1))

## model2: model1 + age + race + education 
model2 <- glm(INJFALLFLG ~ BMI_cat + AGE + RACE + ETHNICNIH + EDUC2, data = subset, family = binomial())
summary(model2)
exp(coef(model2))
exp(confint(model2))

## model3: model2 + physical activity level + smoking + alcohol drinking
model3 <- glm(INJFALLFLG ~ BMI_cat + AGE + RACE + ETHNICNIH + EDUC2 + SMOKNOW + ALCOHOL + totalpa_mins, data = subset, family = binomial())
summary(model3)
exp(coef(model3))
exp(confint(model3))

## model4: model3 + self-rated health
model4 <- glm(INJFALLFLG ~ BMI_cat + AGE + RACE + ETHNICNIH + EDUC2 + SMOKNOW + ALCOHOL + totalpa_mins + HLTHC1Y, data = subset, family = binomial())
summary(model4)
exp(coef(model4))
exp(confint(model4))
```
